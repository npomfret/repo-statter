# Shell Injection Vulnerability

## Problem
- **Location**: `src/git/parser.ts:174-175`, `src/git/parser.ts:187-188`, `src/git/parser.ts:208-209`
- **Description**: User-controlled input (repoPath, commitHash, fileName) is directly interpolated into shell commands without proper escaping
- **Current vs Expected**: Direct string interpolation vs proper escaping or using safer alternatives

## Solution
Use proper escaping for shell commands:

```typescript
import { spawn } from 'child_process'
import { promisify } from 'util'

// Replace execAsync calls with properly escaped commands
const { stdout } = await execAsync(`cd ${JSON.stringify(repoPath)} && git show ${commitHash} --name-only --format=""`, { 
  timeout: 10000 
})

// Better: Use spawn instead of exec for better security
const spawnAsync = promisify(spawn)
```

Or use the simple-git library more extensively instead of raw shell commands.

## Impact
- **Type**: Behavior change - security fix
- **Risk**: High (security vulnerability)
- **Complexity**: Moderate
- **Benefit**: High value - prevents shell injection

## Implementation Notes
Consider using simple-git library methods instead of raw shell commands where possible. For unavoidable shell commands, use proper escaping or the spawn function with argument arrays.