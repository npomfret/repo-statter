<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{repositoryName}} - Repository Statistics</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- Preconnect to CDN domains for faster loading -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://d3js.org" crossorigin>
    <style>
        :root {
            /* Light mode colors */
            --bs-body-bg: #ffffff;
            --bs-body-color: #24292f;
            --bs-border-color: #d1d9e0;
            --bs-card-bg: #ffffff;
            --bs-card-border-color: #d1d9e0;
            --bs-secondary-bg: #f6f8fa;
            --chart-bg: #ffffff;
            --chart-text: #24292f;
            --chart-grid: #e1e4e8;

            /* UI accent colors */
            --accent-primary: #27aeef;
            --accent-success: #87bc45;
            --accent-warning: #ef9b20;
            --accent-info: #b33dc6;
            --accent-danger: #ea5545;
            --accent-secondary: #656d76;

            /* Text colors */
            --text-primary: #24292f;
            --text-secondary: #656d76;
            --text-muted: #8c959f;
            --text-inverse: #f0f6fc;
        }

        [data-bs-theme="dark"] {
            /* Modern dark mode palette inspired by GitHub/VS Code */
            --bs-body-bg: #0d1117;
            --bs-body-color: #f0f6fc;
            --bs-border-color: #21262d;
            --bs-card-bg: #161b22;
            --bs-card-border-color: #30363d;
            --bs-secondary-bg: #21262d;
            --chart-bg: #161b22;
            --chart-text: #f0f6fc;
            --chart-grid: #30363d;

            /* Dark mode accent colors - desaturated for better contrast */
            --accent-primary: #58a6ff;
            --accent-success: #3fb950;
            --accent-warning: #d29922;
            --accent-info: #a5a5ff;
            --accent-danger: #f85149;
            --accent-secondary: #8b949e;

            /* Dark mode text colors */
            --text-primary: #f0f6fc;
            --text-secondary: #c9d1d9;
            --text-muted: #8b949e;
            --text-inverse: #24292f;
        }

        body {
            background-color: var(--bs-body-bg);
            color: var(--bs-body-color);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .card {
            background-color: var(--bs-card-bg);
            border-color: var(--bs-card-border-color);
        }

        .border-bottom {
            border-color: var(--bs-border-color) !important;
        }

        .theme-toggle {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
            margin-left: 15px;
        }

        .theme-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .theme-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bs-border-color);
            transition: 0.4s;
            border-radius: 34px;
        }

        .theme-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: var(--bs-body-bg);
            transition: 0.4s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        input:checked + .theme-slider {
            background-color: var(--accent-primary);
        }

        input:checked + .theme-slider:before {
            transform: translateX(26px);
        }

        .theme-toggle-label {
            font-size: 0.875rem;
            margin-right: 10px;
            color: var(--bs-body-color);
        }

        .theme-controls {
            display: flex;
            align-items: center;
            margin-left: 20px;
        }

        /* Enhanced styling for better visual hierarchy */
        .text-muted {
            color: var(--text-muted) !important;
        }
        
        .text-secondary {
            color: var(--text-secondary) !important;
        }

        .bg-secondary {
            background-color: var(--bs-secondary-bg) !important;
        }

        .border-bottom {
            border-color: var(--bs-border-color) !important;
        }

        /* Card enhancements */
        .card {
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--bs-card-border-color);
            transition: box-shadow 0.3s ease, border-color 0.3s ease;
        }

        [data-bs-theme="dark"] .card {
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        /* Chart container styling */
        .chart-container {
            background-color: var(--chart-bg);
            border-radius: 0.375rem;
            transition: background-color 0.3s ease;
        }

        /* Update text colors to use new accent palette */
        .text-primary {
            color: var(--accent-primary) !important;
        }

        .text-success {
            color: var(--accent-success) !important;
        }

        .text-warning {
            color: var(--accent-warning) !important;
        }

        .text-info {
            color: var(--accent-info) !important;
        }

        .text-danger {
            color: var(--accent-danger) !important;
        }

        /* Custom tooltip styles */
        .custom-tooltip {
            background: var(--bs-card-bg);
            color: var(--bs-body-color);
            border: 1px solid var(--bs-border-color);
            border-radius: 4px;
            padding: 12px;
            font-size: 12px;
            line-height: 1.4;
            min-width: 250px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .custom-tooltip .tooltip-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 8px;
            padding-bottom: 6px;
            border-bottom: 1px solid var(--bs-border-color);
            color: var(--accent-primary);
        }

        .custom-tooltip .tooltip-content > div {
            margin: 4px 0;
        }

        .custom-tooltip .tooltip-message {
            word-wrap: break-word;
            word-break: break-word;
            white-space: pre-wrap;
            max-width: 350px;
        }

        .custom-tooltip strong {
            color: var(--text-secondary);
            margin-right: 4px;
        }

        /* Fix button styling in dark mode */
        [data-bs-theme="dark"] .btn-outline-primary {
            color: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        [data-bs-theme="dark"] .btn-check:checked + .btn-outline-primary,
        [data-bs-theme="dark"] .btn-outline-primary:hover,
        [data-bs-theme="dark"] .btn-outline-primary:focus,
        [data-bs-theme="dark"] .btn-outline-primary:active,
        [data-bs-theme="dark"] .btn-outline-primary.active {
            background-color: var(--accent-primary);
            border-color: var(--accent-primary);
            color: var(--bs-body-bg);
        }

        [data-bs-theme="dark"] .btn-outline-secondary {
            color: var(--accent-secondary);
            border-color: var(--accent-secondary);
        }

        [data-bs-theme="dark"] .btn-check:checked + .btn-outline-secondary,
        [data-bs-theme="dark"] .btn-outline-secondary:hover,
        [data-bs-theme="dark"] .btn-outline-secondary:focus,
        [data-bs-theme="dark"] .btn-outline-secondary:active,
        [data-bs-theme="dark"] .btn-outline-secondary.active {
            background-color: var(--accent-secondary);
            border-color: var(--accent-secondary);
            color: var(--bs-body-bg);
        }
        
        /* File type chart interaction styles */
        #fileTypesChart .apexcharts-pie-slice {
            cursor: pointer;
        }
        
        #fileTypesChart .apexcharts-pie-slice:hover {
            filter: brightness(1.1);
        }
        
        /* Hero Strip Styles */
        .hero-strip {
            background: linear-gradient(135deg, var(--bs-secondary-bg) 0%, var(--bs-body-bg) 100%);
            border-bottom: 1px solid var(--bs-border-color);
            padding: 1.5rem 0;
        }
        
        .metric-card {
            background: var(--bs-card-bg);
            border: 1px solid var(--bs-card-border-color);
            border-radius: 0.5rem;
            padding: 1.25rem;
            text-align: center;
            transition: all 0.3s ease;
            height: 100%;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        [data-bs-theme="dark"] .metric-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .metric-label {
            color: var(--text-muted);
            font-size: 0.875rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            line-height: 1.2;
        }
        
        @media (max-width: 768px) {
            .metric-value {
                font-size: 1.5rem;
            }
        }
        
        /* Sticky Navigation Styles */
        .sticky-nav {
            position: fixed;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            background: var(--bs-card-bg);
            border: 1px solid var(--bs-card-border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            max-height: 80vh;
            overflow-y: auto;
            width: 180px;
        }
        
        [data-bs-theme="dark"] .sticky-nav {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .sticky-nav nav {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .sticky-nav a {
            display: block;
            padding: 0.5rem 0.75rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.25rem;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            position: relative;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .sticky-nav a:hover {
            color: var(--text-primary);
            background: var(--bs-secondary-bg);
        }
        
        .sticky-nav a.active {
            color: var(--accent-primary);
            font-weight: 600;
        }
        
        .sticky-nav a.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 60%;
            background: var(--accent-primary);
            border-radius: 2px;
        }
        
        /* Main content adjustment */
        .main-content {
            margin-left: 200px;
            padding-right: 20px;
            transition: margin-left 0.3s ease;
            overflow-x: hidden;
        }
        
        /* Mobile navigation */
        @media (max-width: 991px) {
            .sticky-nav {
                position: fixed;
                left: 0;
                right: 0;
                top: auto;
                bottom: 0;
                transform: none;
                border-radius: 0;
                border-left: none;
                border-right: none;
                border-bottom: none;
                padding: 0.5rem;
                max-height: none;
                overflow-x: auto;
                overflow-y: hidden;
            }
            
            .sticky-nav nav {
                flex-direction: row;
                gap: 0.25rem;
                white-space: nowrap;
            }
            
            .sticky-nav a {
                padding: 0.5rem 1rem;
                flex-shrink: 0;
            }
            
            .sticky-nav a.active::before {
                top: auto;
                bottom: 0;
                left: 50%;
                transform: translateX(-50%);
                width: 60%;
                height: 3px;
            }
            
            .main-content {
                margin-left: 0;
                padding-right: 15px;
                padding-left: 15px;
                margin-bottom: 60px;
            }
        }
        
        /* Accordion Styles */
        .accordion-button {
            background-color: var(--bs-card-bg);
            color: var(--bs-body-color);
            border: none;
            font-weight: 600;
            font-size: 1.1rem;
            padding: 1rem 1.25rem;
            transition: all 0.3s ease;
        }
        
        .accordion-button:not(.collapsed) {
            background-color: var(--bs-secondary-bg);
            color: var(--accent-primary);
            box-shadow: none;
        }
        
        .accordion-button:focus {
            box-shadow: 0 0 0 0.25rem rgba(var(--accent-primary), 0.25);
            border-color: transparent;
        }
        
        .accordion-button::after {
            background-image: none;
            content: '\25BC';
            font-size: 0.8rem;
            transform: rotate(0deg);
            transition: transform 0.3s ease;
        }
        
        .accordion-button:not(.collapsed)::after {
            transform: rotate(-180deg);
        }
        
        .accordion-item {
            background-color: var(--bs-card-bg);
            border: 1px solid var(--bs-card-border-color);
            margin-bottom: 0.5rem;
        }
        
        .accordion-item:first-of-type,
        .accordion-item:last-of-type {
            border-radius: 0.5rem;
        }
        
        .accordion-body {
            padding: 1.25rem;
            background-color: var(--bs-card-bg);
        }
        
        [data-bs-theme="dark"] .accordion-button::after {
            filter: invert(1);
        }
        
        /* Loading text for accessibility */
        .chart-loading-text {
            position: absolute;
            left: -9999px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }
        
        /* Remove placeholder styling once chart is rendered */
        .chart-rendered {
            background-color: transparent;
            min-height: auto !important;
            animation: none;
        }
        
        /* CSS Grid Layout System */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        /* Grid column spans */
        .grid-col-1 { grid-column: span 1; }
        .grid-col-2 { grid-column: span 2; }
        .grid-col-3 { grid-column: span 3; }
        .grid-col-4 { grid-column: span 4; }
        .grid-col-6 { grid-column: span 6; }
        .grid-col-8 { grid-column: span 8; }
        .grid-col-9 { grid-column: span 9; }
        .grid-col-12 { grid-column: span 12; }
        
        /* Specific grid item types */
        .metric-card-grid { grid-column: span 3; }
        .chart-full { grid-column: span 12; }
        .chart-half { grid-column: span 6; }
        .chart-third { grid-column: span 4; }
        
        /* Tablet breakpoint (768px - 1024px) */
        @media (max-width: 1024px) and (min-width: 768px) {
            .dashboard-grid {
                gap: 1rem;
            }
            
            .metric-card-grid { grid-column: span 6; }
            .chart-half { grid-column: span 12; }
            .chart-third { grid-column: span 6; }
        }
        
        /* Mobile breakpoint (< 768px) */
        @media (max-width: 767px) {
            .dashboard-grid {
                grid-template-columns: repeat(6, 1fr);
                gap: 0.75rem;
            }
            
            .metric-card-grid { grid-column: span 6; }
            .chart-full { grid-column: span 6; }
            .chart-half { grid-column: span 6; }
            .chart-third { grid-column: span 6; }
            .grid-col-1,
            .grid-col-2,
            .grid-col-3,
            .grid-col-4,
            .grid-col-6,
            .grid-col-8,
            .grid-col-9,
            .grid-col-12 {
                grid-column: span 6;
            }
        }
        
        /* Enhanced mobile breakpoint (â‰¤ 600px) for better UX */
        @media (max-width: 600px) {
            /* Stack metric cards in 2-column grid */
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
                margin-bottom: 1rem;
            }
            
            .metric-card-grid { grid-column: span 1; }
            .chart-full,
            .chart-half,
            .chart-third { 
                grid-column: span 2; 
            }
            
            /* Mobile-first accordion behavior - single expanded section */
            .accordion {
                margin-bottom: 1rem;
            }
            
            .accordion-item {
                margin-bottom: 0.25rem;
            }
            
            .accordion-button {
                font-size: 1rem;
                padding: 0.875rem 1rem;
                min-height: 44px; /* Touch-friendly minimum */
            }
            
            /* Chart containers become full-width and swipeable */
            .chart-container {
                min-height: 300px;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            /* Reduce spacing for mobile */
            .main-content {
                padding-right: 0.75rem;
                padding-left: 0.75rem;
            }
            
            .hero-strip {
                padding: 1rem 0;
            }
            
            .metric-card {
                padding: 0.75rem;
                font-size: 0.875rem;
            }
            
            .metric-value {
                font-size: 1.25rem;
            }
            
            /* Improve tab navigation for touch */
            .nav-tabs .nav-link {
                padding: 0.75rem 1rem;
                min-height: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            /* Remove hover effects on touch devices */
            .metric-card:hover {
                transform: none;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            }
            
            [data-bs-theme="dark"] .metric-card:hover {
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            }
            
            /* Enhance touch targets for all interactive elements */
            .btn,
            .nav-link,
            .accordion-button,
            .form-control,
            .form-select {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* Improve filter controls for touch */
            .input-group .form-control {
                padding: 0.75rem;
            }
            
            .btn-group .btn {
                padding: 0.5rem 0.875rem;
            }
            
            /* Better spacing for filter section */
            .accordion-body .dashboard-grid {
                gap: 0.75rem;
            }
            
            /* Enhanced sticky nav for mobile */
            .sticky-nav a {
                min-height: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }
        
        /* CSS Custom Properties for consistent spacing */
        :root {
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-xxl: 3rem;
            
            --radius-sm: 0.25rem;
            --radius-md: 0.375rem;
            --radius-lg: 0.5rem;
            --radius-xl: 0.75rem;
        }
        
        /* Apply consistent spacing to cards */
        .dashboard-grid .card {
            margin-bottom: 0; /* Remove Bootstrap's default margin */
            border-radius: var(--radius-lg);
            height: 100%; /* Ensure cards fill their grid cells */
        }
        
        .dashboard-grid .card-body {
            padding: var(--space-lg);
        }
        
        /* Ensure charts fill their containers */
        .dashboard-grid .chart-container {
            height: 100%;
            min-height: 350px;
        }
        
        /* Special handling for metric cards */
        .metric-card {
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        /* Ensure consistent spacing in accordion bodies */
        .accordion-body .dashboard-grid {
            margin-bottom: 0;
        }
        
        /* Skip link accessibility */
        .visually-hidden-focusable {
            position: absolute !important;
            left: -9999px !important;
            width: 1px !important;
            height: 1px !important;
            overflow: hidden !important;
        }
        
        .visually-hidden-focusable:focus {
            position: fixed !important;
            top: 10px !important;
            left: 10px !important;
            width: auto !important;
            height: auto !important;
            padding: 0.5rem 1rem !important;
            background: var(--accent-primary) !important;
            color: white !important;
            text-decoration: none !important;
            border-radius: 0.25rem !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) !important;
            z-index: 9999 !important;
            font-weight: 600 !important;
            overflow: visible !important;
        }
        
        /* Enhanced focus indicators for better accessibility */
        :focus {
            outline: 2px solid var(--accent-primary) !important;
            outline-offset: 2px !important;
        }
        
        /* Focus styles for interactive elements */
        .nav-link:focus,
        .btn:focus,
        .form-control:focus,
        .form-select:focus,
        .accordion-button:focus {
            box-shadow: 0 0 0 0.25rem rgba(39, 174, 239, 0.25) !important;
        }
        
        /* Dark mode focus adjustments */
        [data-bs-theme="dark"] :focus {
            outline-color: var(--accent-primary) !important;
        }
    </style>
</head>
<body>
    <!-- Sticky Navigation -->
    <!-- Skip to main content link -->
    <a href="#main-content" class="visually-hidden-focusable">Skip to main content</a>
    
    <aside class="sticky-nav" role="navigation" aria-label="Page sections navigation">
        <nav>
            <a href="#overview" class="active">Overview</a>
            <a href="#activity">Activity</a>
            <a href="#code-analysis">Code Analysis</a>
            <a href="#contributors">Contributors</a>
        </nav>
    </aside>
    
    <div class="main-content">
        <header class="py-3 mb-4 border-bottom" role="banner">
            <div class="row align-items-center">
                <div class="col">
                    <div class="d-flex align-items-center">
                        <div class="me-3" style="width: 48px; height: 48px; flex-shrink: 0; overflow: hidden;">
                            <div style="width: 100%; height: 100;">
                                {{logoSvg}}
                            </div>
                        </div>
                        <div>
                            <h5 class="mb-0 fw-semibold">Repository Statistics for {{repositoryName}}</h5>
                            <small class="text-muted">Generated by repo-statter{{githubLink}}</small>
                        </div>
                    </div>
                </div>
                <div class="col-auto">
                    <div class="d-flex flex-column align-items-end">
                        <div class="theme-controls mb-2">
                            <span class="theme-toggle-label">Dark Mode</span>
                            <label class="theme-toggle" for="themeToggle">
                                <input type="checkbox" id="themeToggle" aria-describedby="theme-description">
                                <span class="theme-slider"></span>
                            </label>
                            <div class="visually-hidden" id="theme-description">Toggle between light and dark mode for better visibility</div>
                        </div>
                        <div class="text-muted small">Report Generated: <span class="badge bg-dark">{{generationDate}}</span></div>
                        <div class="text-muted small">Latest Commit: <span class="fw-semibold">{{latestCommitHash}}</span> by <span class="fw-semibold">{{latestCommitAuthor}}</span> on <span class="fw-semibold">{{latestCommitDate}}</span></div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Live region for dynamic announcements -->
        <div id="live-region" aria-live="polite" aria-atomic="true" class="visually-hidden"></div>
        
        <!-- Main content area -->
        <main id="main-content" role="main" aria-label="Repository statistics dashboard">
        
        <!-- Hero Strip with Key Metrics -->
        <div class="hero-strip mb-4" role="region" aria-labelledby="metrics-heading">
            <h2 id="metrics-heading" class="visually-hidden">Key Repository Metrics</h2>
            <div class="dashboard-grid">
                <div class="metric-card-grid">
                    <div class="metric-card" role="img" aria-labelledby="commits-label" aria-describedby="commits-desc">
                        <div class="metric-label" id="commits-label">Total Commits</div>
                        <div class="metric-value text-primary">{{totalCommits}}</div>
                        <div class="visually-hidden" id="commits-desc">Total number of commits in the repository</div>
                    </div>
                </div>
                <div class="metric-card-grid">
                    <div class="metric-card" role="img" aria-labelledby="loc-label" aria-describedby="loc-desc">
                        <div class="metric-label" id="loc-label">Lines of Code</div>
                        <div class="metric-value text-success">{{totalLinesOfCode}}</div>
                        <div class="visually-hidden" id="loc-desc">Total lines of code in the repository</div>
                    </div>
                </div>
                <div class="metric-card-grid">
                    <div class="metric-card" role="img" aria-labelledby="contributors-label" aria-describedby="contributors-desc">
                        <div class="metric-label" id="contributors-label">Contributors</div>
                        <div class="metric-value text-info">{{totalContributors}}</div>
                        <div class="visually-hidden" id="contributors-desc">Number of unique contributors to the repository</div>
                    </div>
                </div>
                <div class="metric-card-grid">
                    <div class="metric-card" role="img" aria-labelledby="active-days-label" aria-describedby="active-days-desc">
                        <div class="metric-label" id="active-days-label">Active Days</div>
                        <div class="metric-value text-warning">{{activeDays}}</div>
                        <div class="visually-hidden" id="active-days-desc">Number of days with commit activity</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Overview Section with Accordions -->
        <section id="overview" role="region" aria-labelledby="overview-heading">
            <h2 id="overview-heading" class="visually-hidden">Overview and Data Filters</h2>
            <div class="accordion" id="overviewAccordion">
                <!-- Filter Controls Accordion -->
                <div class="accordion-item">
                    <h3 class="accordion-header" id="filterHeading">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#filterCollapse" aria-expanded="true" aria-controls="filterCollapse">
                            <i class="bi bi-funnel me-2"></i> Filter Data
                        </button>
                    </h3>
                    <div id="filterCollapse" class="accordion-collapse collapse show" aria-labelledby="filterHeading" data-bs-parent="#overviewAccordion">
                        <div class="accordion-body">
                            <div class="dashboard-grid">
                                <div class="chart-third">
                                    <label class="form-label" for="authorFilter">Author</label>
                                    <select class="form-select" id="authorFilter">
                                        <option value="">All Authors</option>
                                    </select>
                                </div>
                                <div class="chart-third">
                                    <label class="form-label">Date Range</label>
                                    <div class="input-group">
                                        <input type="date" class="form-control" id="dateFromFilter" aria-label="Start date">
                                        <span class="input-group-text">to</span>
                                        <input type="date" class="form-control" id="dateToFilter" aria-label="End date">
                                    </div>
                                </div>
                                <div class="chart-third">
                                    <label class="form-label">File Types</label>
                                    <div class="border rounded p-2" style="max-height: 200px; overflow-y: auto;">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="fileTypeSelectAll">
                                            <label class="form-check-label fw-bold" for="fileTypeSelectAll">
                                                Select All
                                            </label>
                                        </div>
                                        <hr class="my-1">
                                        <div id="fileTypeFilterContainer">
                                            <!-- File type checkboxes will be populated here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-3">
                                <button class="btn btn-primary btn-sm" id="applyFilters" aria-describedby="filter-help">Apply Filters</button>
                                <button class="btn btn-outline-secondary btn-sm ms-2" id="clearFilters" aria-describedby="filter-help">Clear Filters</button>
                                <small class="text-muted ms-3" id="filterStatus" role="status" aria-live="polite">Showing all commits</small>
                                <div class="visually-hidden" id="filter-help">Use filters to focus on specific authors, date ranges, or file types. Changes will update all charts in real-time.</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Time Range and Contributors Accordion -->
                <div class="accordion-item">
                    <h3 class="accordion-header" id="timeRangeHeading">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#timeRangeCollapse" aria-expanded="true" aria-controls="timeRangeCollapse">
                            <i class="bi bi-clock-history me-2"></i> Time Range Selector
                        </button>
                    </h3>
                    <div id="timeRangeCollapse" class="accordion-collapse collapse show" aria-labelledby="timeRangeHeading" data-bs-parent="#overviewAccordion">
                        <div class="accordion-body">
                            <p class="text-muted mb-3">Adjust the time range for all time series charts using the slider below:</p>
                            <div id="timeSliderChart" style="width: 100%; min-height: 150px;" data-chart-type="timeSlider" aria-label="Time range slider chart" aria-describedby="time-slider-desc">
                                <div class="visually-hidden" id="time-slider-desc">Interactive timeline showing repository activity. Drag the handles to filter data by date range across all charts.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Activity Section -->
        <section id="activity" role="region" aria-labelledby="activity-heading">
            <h2 id="activity-heading" class="visually-hidden">Repository Activity and Growth</h2>
            <div class="accordion mb-4" id="activityAccordion">
                <div class="accordion-item">
                    <h3 class="accordion-header" id="activityHeading">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#activityCollapse" aria-expanded="true" aria-controls="activityCollapse">
                            <i class="bi bi-graph-up me-2"></i> Activity & Growth Charts
                        </button>
                    </h3>
                    <div id="activityCollapse" class="accordion-collapse collapse show" aria-labelledby="activityHeading" data-bs-parent="#activityAccordion">
                        <div class="accordion-body">
            <div class="dashboard-grid">
                <!-- Growth Over Time Chart -->
                <div class="chart-full">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Growth Over Time</h5>
                        </div>
                        <div class="card-body">
                            <div class="btn-group btn-group-sm mb-3" role="group">
                                <input type="radio" class="btn-check" name="growthXAxis" id="growthXAxisDate" value="date">
                                <label class="btn btn-outline-primary" for="growthXAxisDate">By Date</label>
                                <input type="radio" class="btn-check" name="growthXAxis" id="growthXAxisCommit" value="commit" checked>
                                <label class="btn btn-outline-primary" for="growthXAxisCommit">By Commit</label>
                            </div>
                            <div id="growthChart" style="min-height: 350px;" data-chart-type="growth" aria-label="Repository growth chart" aria-describedby="growth-desc">
                                <div class="visually-hidden" id="growth-desc">Line chart showing cumulative growth of lines of code, commits, and contributors over time. Switch between date-based and commit-based x-axis views.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lines of Code by Category Chart -->
                <div class="chart-full">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Lines of Code by Category</h5>
                        </div>
                        <div class="card-body">
                            <div id="categoryLinesChart" style="min-height: 350px;" data-chart-type="categoryLines" aria-label="Lines of code by category chart">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Commit Activity Chart -->
                <div class="chart-full">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Commit Activity Over Time</h5>
                        </div>
                        <div class="card-body">
                            <div id="commitActivityChart" style="min-height: 350px;" data-chart-type="commitActivity" aria-label="Commit activity chart">
                            </div>
                        </div>
                    </div>
                </div>

            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Code Analysis Section -->
        <section id="code-analysis" role="region" aria-labelledby="code-analysis-heading">
            <h2 id="code-analysis-heading" class="visually-hidden">Code Analysis and File Metrics</h2>
            <div class="accordion mb-4" id="codeAccordion">
                <div class="accordion-item">
                    <h3 class="accordion-header" id="codeHeading">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#codeCollapse" aria-expanded="true" aria-controls="codeCollapse">
                            <i class="bi bi-code-slash me-2"></i> Code Analysis & File Metrics
                        </button>
                    </h3>
                    <div id="codeCollapse" class="accordion-collapse collapse show" aria-labelledby="codeHeading" data-bs-parent="#codeAccordion">
                        <div class="accordion-body">
                            <div class="dashboard-grid">
                                <!-- File Types Chart -->
                                <div class="chart-half">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="card-title mb-0">File Types</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="fileTypesChart" style="min-height: 350px;" data-chart-type="fileTypes" aria-label="File types distribution chart" aria-describedby="file-types-desc">
                                                <div class="visually-hidden" id="file-types-desc">Pie chart showing distribution of code across different file types. Click segments to filter other charts by file type.</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Top 5 Files Chart -->
                                <div class="chart-half">
                                    <div class="card">
                                        <div class="card-header">
                                            <ul class="nav nav-tabs card-header-tabs" role="tablist">
                                                <li class="nav-item">
                                                    <button class="nav-link active" id="largest-tab" data-bs-toggle="tab" data-bs-target="#largest-pane" type="button" role="tab" aria-controls="largest-pane" aria-selected="true">Largest</button>
                                                </li>
                                                <li class="nav-item">
                                                    <button class="nav-link" id="churn-tab" data-bs-toggle="tab" data-bs-target="#churn-pane" type="button" role="tab" aria-controls="churn-pane" aria-selected="false">Most Churn</button>
                                                </li>
                                                <li class="nav-item">
                                                    <button class="nav-link" id="complex-tab" data-bs-toggle="tab" data-bs-target="#complex-pane" type="button" role="tab" aria-controls="complex-pane" aria-selected="false">Most Complex</button>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="card-body">
                                            <div id="fileTypeFilterIndicator" class="alert alert-info mb-3 d-none" role="alert">
                                                <i class="bi bi-funnel"></i> Showing only <strong id="selectedFileType"></strong> files
                                                <button type="button" class="btn-close btn-sm float-end" aria-label="Clear filter" id="clearFileTypeFilter"></button>
                                            </div>
                                            <div class="tab-content">
                                                <div class="tab-pane fade show active" id="largest-pane" role="tabpanel" aria-labelledby="largest-tab" tabindex="0">
                                                    <p class="card-text small text-muted mb-3">
                                                        Files with the most lines of code in the repository
                                                    </p>
                                                </div>
                                                <div class="tab-pane fade" id="churn-pane" role="tabpanel" aria-labelledby="churn-tab" tabindex="0">
                                                    <p class="card-text small text-muted mb-3">
                                                        Files with the most changes (lines added + deleted)
                                                    </p>
                                                </div>
                                                <div class="tab-pane fade" id="complex-pane" role="tabpanel" aria-labelledby="complex-tab" tabindex="0">
                                                    <p class="card-text small text-muted mb-3">
                                                        Files with the highest complexity scores
                                                    </p>
                                                </div>
                                            </div>
                                            <div id="topFilesChart" style="min-height: 350px;" data-chart-type="topFiles" aria-label="Top files by size chart" aria-describedby="top-files-desc">
                                                <div class="visually-hidden" id="top-files-desc">Horizontal bar chart showing top 5 files by selected metric. Use tabs to switch between largest files, most churned files, and most complex files.</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- File Heatmap -->
                                <div class="chart-full">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="card-title mb-0">File Activity Heatmap</h5>
                                        </div>
                                        <div class="card-body" style="min-height: 400px;">
                                            <p class="card-text">Interactive treemap showing file activity based on commit frequency and recency. Larger rectangles represent files with more lines of code, while color intensity indicates higher activity.</p>
                                            <div id="fileHeatmapChart" style="width: 100%; height: 400px;" data-chart-type="fileHeatmap" aria-label="File activity heatmap">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        
        <!-- Contributors Section -->
        <section id="contributors" role="region" aria-labelledby="contributors-heading">
            <h2 id="contributors-heading" class="visually-hidden">Contributors and Awards</h2>
            <div class="accordion mb-4" id="contributorsAccordion">
                <div class="accordion-item">
                    <h3 class="accordion-header" id="contributorsHeading">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#contributorsCollapse" aria-expanded="true" aria-controls="contributorsCollapse">
                            <i class="bi bi-people me-2"></i> Contributors & Awards
                        </button>
                    </h3>
                    <div id="contributorsCollapse" class="accordion-collapse collapse show" aria-labelledby="contributorsHeading" data-bs-parent="#contributorsAccordion">
                        <div class="accordion-body">
            <!-- Awards Section -->
            <div class="dashboard-grid">
                <div class="chart-full">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Commit Awards</h5>
                        </div>
                        <div class="card-body">
                            <div class="dashboard-grid" id="awardsContainer">
                                <!-- Awards will be populated dynamically -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- User-Specific Time Series Charts -->
                <div class="chart-full">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Per-User Activity Charts</h5>
                        </div>
                        <div class="card-body">
                            <div class="dashboard-grid" id="userChartsContainer">
                                <!-- User charts will be populated dynamically -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Bottom Section: Contributors and Word Cloud -->
        <section id="bottom-section">
            <div class="dashboard-grid">
                <!-- Contributors Chart -->
                <div class="chart-half">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Top Contributors</h5>
                        </div>
                        <div class="card-body">
                            <div id="contributorsChart" style="min-height: 350px;" data-chart-type="contributors" aria-label="Contributors activity chart" aria-describedby="contributors-chart-desc">
                                <div class="visually-hidden" id="contributors-chart-desc">Horizontal bar chart ranking top contributors by their total lines of code contributions to the repository.</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Word Cloud -->
                <div class="chart-half">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Commit Message Word Cloud</h5>
                        </div>
                        <div class="card-body" style="min-height: 400px;">
                            <div id="wordCloudChart" style="width: 100%; height: 400px;" data-chart-type="wordCloud" aria-label="Commit message word cloud" aria-describedby="word-cloud-desc">
                                <div class="visually-hidden" id="word-cloud-desc">Visual word cloud of most frequently used words in commit messages. Larger words appear more often across commits.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <!-- Load chart libraries with defer to not block page rendering -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.54.0/dist/apexcharts.min.js" crossorigin="anonymous" defer></script>
    <script src="https://d3js.org/d3.v7.min.js" crossorigin="anonymous" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-cloud@1.2.7/build/d3.layout.cloud.js" crossorigin="anonymous" defer></script>

    <!-- Mobile optimizations -->
    <script>
        // Mobile-specific optimizations for accordion behavior
        function isMobileDevice() {
            return window.innerWidth <= 600;
        }

        // Handle mobile accordion behavior - only one section open at a time
        function initMobileAccordions() {
            if (!isMobileDevice()) return;
            
            const accordions = document.querySelectorAll('.accordion');
            
            accordions.forEach(accordion => {
                const accordionButtons = accordion.querySelectorAll('.accordion-button');
                
                accordionButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        if (!isMobileDevice()) return;
                        
                        const targetId = this.getAttribute('data-bs-target');
                        const targetCollapse = document.querySelector(targetId);
                        
                        // On mobile, close other accordions in the same accordion group
                        setTimeout(() => {
                            const otherCollapses = accordion.querySelectorAll('.accordion-collapse.show');
                            otherCollapses.forEach(collapse => {
                                if (collapse !== targetCollapse) {
                                    const collapseInstance = bootstrap.Collapse.getInstance(collapse);
                                    if (collapseInstance) {
                                        collapseInstance.hide();
                                    }
                                }
                            });
                        }, 50);
                    });
                });
            });
        }

        // Add touch feedback to interactive elements
        function initTouchFeedback() {
            if (!isMobileDevice()) return;
            
            const touchElements = document.querySelectorAll('.btn, .nav-link, .accordion-button, .metric-card');
            
            touchElements.forEach(element => {
                element.addEventListener('touchstart', function() {
                    this.style.transform = 'scale(0.98)';
                    this.style.transition = 'transform 0.1s ease';
                });
                
                element.addEventListener('touchend', function() {
                    this.style.transform = 'scale(1)';
                    setTimeout(() => {
                        this.style.transition = '';
                    }, 100);
                });
            });
        }

        // Swipe gestures for section navigation (basic implementation)
        function initSwipeNavigation() {
            if (!isMobileDevice()) return;
            
            let startX = 0;
            let startY = 0;
            
            document.addEventListener('touchstart', function(e) {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
            });
            
            document.addEventListener('touchend', function(e) {
                if (!startX || !startY) return;
                
                const endX = e.changedTouches[0].clientX;
                const endY = e.changedTouches[0].clientY;
                
                const deltaX = endX - startX;
                const deltaY = endY - startY;
                
                // Only process horizontal swipes
                if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 100) {
                    const navLinks = document.querySelectorAll('.sticky-nav a');
                    const activeLink = document.querySelector('.sticky-nav a.active');
                    const currentIndex = Array.from(navLinks).indexOf(activeLink);
                    
                    let targetIndex;
                    if (deltaX > 0 && currentIndex > 0) {
                        // Swipe right - go to previous section
                        targetIndex = currentIndex - 1;
                    } else if (deltaX < 0 && currentIndex < navLinks.length - 1) {
                        // Swipe left - go to next section
                        targetIndex = currentIndex + 1;
                    }
                    
                    if (targetIndex !== undefined) {
                        navLinks[targetIndex].click();
                    }
                }
                
                startX = 0;
                startY = 0;
            });
        }

        // Initialize mobile optimizations when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            initMobileAccordions();
            initTouchFeedback();
            initSwipeNavigation();
            
            // Reinitialize on window resize
            window.addEventListener('resize', function() {
                setTimeout(() => {
                    initMobileAccordions();
                    initTouchFeedback();
                    initSwipeNavigation();
                }, 100);
            });
        });
    </script>
</body>
</html>