#!/usr/bin/env node
import { readFileSync, writeFileSync } from 'fs'
import { join, dirname } from 'path'
import { fileURLToPath } from 'url'

const __filename = fileURLToPath(import.meta.url)
const __dirname = dirname(__filename)

const templatePath = join(__dirname, '../src/report/template.html')
const outputPath = join(__dirname, '../src/report/template-embedded.ts')

const template = readFileSync(templatePath, 'utf-8')
const escaped = template
  .replace(/\\/g, '\\\\')  // Escape backslashes first
  .replace(/`/g, '\\`')    // Escape backticks
  .replace(/\$/g, '\\$')   // Escape dollar signs

const output = `// This file is auto-generated by scripts/embed-template.js
export const TEMPLATE_HTML = \`${escaped}\`
`

writeFileSync(outputPath, output)
console.log('Template embedded successfully')